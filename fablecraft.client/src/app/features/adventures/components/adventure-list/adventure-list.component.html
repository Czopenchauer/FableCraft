<div class="adventures-container">
  <div class="adventures-content">
    <!-- Header -->
    <div class="adventures-header">
      <div class="header-left">
        <button
          (click)="goBack()"
          class="back-button"
        >
          <svg [attr.fill]="'none'" [attr.stroke]="'currentColor'" viewBox="0 0 24 24">
            <path [attr.stroke-linecap]="'round'" [attr.stroke-linejoin]="'round'" [attr.stroke-width]="2" [attr.d]="'M10 19l-7-7m0 0l7-7m-7 7h18'"></path>
          </svg>
        </button>
        <h1 class="page-title">
          Your Adventures
        </h1>
      </div>
      <button
        (click)="createNewAdventure()"
        class="btn-new-adventure"
      >
        <svg [attr.fill]="'none'" [attr.stroke]="'currentColor'" viewBox="0 0 24 24">
          <path [attr.stroke-linecap]="'round'" [attr.stroke-linejoin]="'round'" [attr.stroke-width]="2" [attr.d]="'M12 4v16m8-8H4'"></path>
        </svg>
        <span>New Adventure</span>
      </button>
    </div>

    <!-- Loading State -->
    <div *ngIf="loading" class="loading-state">
      <div class="loading-content">
        <svg class="spinner" [attr.fill]="'none'" viewBox="0 0 24 24">
          <circle class="opacity-25" [attr.cx]="12" [attr.cy]="12" [attr.r]="10" [attr.stroke]="'currentColor'" [attr.stroke-width]="4"></circle>
          <path class="opacity-75" [attr.fill]="'currentColor'" [attr.d]="'M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z'"></path>
        </svg>
        <p class="loading-text">Loading adventures...</p>
      </div>
    </div>

    <!-- Error State -->
    <div *ngIf="error && !loading" class="error-state">
      <div class="error-content">
        <svg class="error-icon" [attr.fill]="'none'" [attr.stroke]="'currentColor'" viewBox="0 0 24 24">
          <path [attr.stroke-linecap]="'round'" [attr.stroke-linejoin]="'round'" [attr.stroke-width]="2" [attr.d]="'M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z'"></path>
        </svg>
        <div class="error-text">
          <h3 class="error-title">Error Loading Adventures</h3>
          <p class="error-message">{{ error }}</p>
          <p class="error-note">
            Note: You need to implement <code class="error-code">GET /api/adventure</code> endpoint in the backend.
          </p>
        </div>
      </div>
    </div>

    <!-- Empty State -->
    <div *ngIf="!loading && !error && adventures.length === 0" class="empty-state">
      <div class="empty-content">
        <svg class="empty-icon" [attr.fill]="'none'" [attr.stroke]="'currentColor'" viewBox="0 0 24 24">
          <path [attr.stroke-linecap]="'round'" [attr.stroke-linejoin]="'round'" [attr.stroke-width]="2" [attr.d]="'M12 6.253v13m0-13C10.832 5.477 9.246 5 7.5 5S4.168 5.477 3 6.253v13C4.168 18.477 5.754 18 7.5 18s3.332.477 4.5 1.253m0-13C13.168 5.477 14.754 5 16.5 5c1.747 0 3.332.477 4.5 1.253v13C19.832 18.477 18.247 18 16.5 18c-1.746 0-3.332.477-4.5 1.253'"></path>
        </svg>
        <h2 class="empty-title">No Adventures Yet</h2>
        <p class="empty-description">
          Start your journey by creating your first adventure. Define your world, create your character, and let the AI craft your unique story.
        </p>
        <button
          (click)="createNewAdventure()"
          class="btn-create-first"
        >
          <svg [attr.fill]="'none'" [attr.stroke]="'currentColor'" viewBox="0 0 24 24">
            <path [attr.stroke-linecap]="'round'" [attr.stroke-linejoin]="'round'" [attr.stroke-width]="2" [attr.d]="'M12 4v16m8-8H4'"></path>
          </svg>
          <span>Create Your First Adventure</span>
        </button>
      </div>
    </div>

    <!-- Adventures Grid -->
    <div *ngIf="!loading && adventures.length > 0" class="adventures-grid">
      <div
        *ngFor="let adventure of adventures"
        (click)="openAdventure(adventure)"
        class="adventure-card"
      >
        <!-- Delete Button -->
        <button
          (click)="deleteAdventure($event, adventure.adventureId, adventure.name)"
          class="delete-button"
          title="Delete adventure"
        >
          <svg [attr.fill]="'none'" [attr.stroke]="'currentColor'" viewBox="0 0 24 24">
            <path [attr.stroke-linecap]="'round'" [attr.stroke-linejoin]="'round'" [attr.stroke-width]="2" [attr.d]="'M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16'"></path>
          </svg>
        </button>

        <!-- Title and Description -->
        <h3 class="card-title">
          {{ adventure.name }}
        </h3>
        <p class="card-description">
          {{ adventure.lastScenePreview || 'No preview available' }}
        </p>

        <!-- Meta Information -->
        <div class="card-meta">
          <div class="meta-item">
            <svg [attr.fill]="'none'" [attr.stroke]="'currentColor'" viewBox="0 0 24 24">
              <path [attr.stroke-linecap]="'round'" [attr.stroke-linejoin]="'round'" [attr.stroke-width]="2" [attr.d]="'M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z'"></path>
            </svg>
            <span>Created: {{ adventure.created | date:'short' }}</span>
          </div>
          <div class="meta-item" *ngIf="adventure.lastPlayed">
            <svg [attr.fill]="'none'" [attr.stroke]="'currentColor'" viewBox="0 0 24 24">
              <path [attr.stroke-linecap]="'round'" [attr.stroke-linejoin]="'round'" [attr.stroke-width]="2" [attr.d]="'M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z'"></path>
            </svg>
            <span>Last Played: {{ adventure.lastPlayed | date:'short' }}</span>
          </div>
        </div>

        <!-- Hover Arrow -->
        <div class="card-arrow">
          <svg [attr.fill]="'none'" [attr.stroke]="'currentColor'" viewBox="0 0 24 24">
            <path [attr.stroke-linecap]="'round'" [attr.stroke-linejoin]="'round'" [attr.stroke-width]="2" [attr.d]="'M13 7l5 5m0 0l-5 5m5-5H6'"></path>
          </svg>
        </div>
      </div>
    </div>
  </div>

  <!-- Delete Confirmation Modal -->
  <app-delete-confirmation-modal
    [isOpen]="showDeleteModal"
    [adventureName]="adventureToDelete?.name || ''"
    [isDeleting]="isDeleting"
    (confirm)="confirmDelete()"
    (cancel)="cancelDelete()">
  </app-delete-confirmation-modal>
</div>
