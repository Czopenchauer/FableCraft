<div class="form-container">
  <div class="form-content">
    <!-- Header -->
    <div class="form-header">
      <div class="header-left">
        <button (click)="cancel()" class="back-button">
          <svg [attr.fill]="'none'" [attr.stroke]="'currentColor'" viewBox="0 0 24 24">
            <path [attr.d]="'M10 19l-7-7m0 0l7-7m-7 7h18'" [attr.stroke-linecap]="'round'"
                  [attr.stroke-linejoin]="'round'" [attr.stroke-width]="2"></path>
          </svg>
        </button>
        <h1 class="page-title">{{ isEditMode ? 'Edit Worldbook' : 'Create Worldbook' }}</h1>
      </div>
    </div>

    <!-- Loading State -->
    <div *ngIf="loading" class="loading-state">
      <div class="loading-content">
        <svg [attr.fill]="'none'" class="spinner" viewBox="0 0 24 24">
          <circle [attr.cx]="12" [attr.cy]="12" [attr.r]="10" [attr.stroke-width]="4" [attr.stroke]="'currentColor'"
                  class="opacity-25"></circle>
          <path
            [attr.d]="'M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z'"
            [attr.fill]="'currentColor'" class="opacity-75"></path>
        </svg>
        <p class="loading-text">Loading worldbook...</p>
      </div>
    </div>

    <!-- Error State -->
    <div *ngIf="error" class="error-state">
      <div class="error-content">
        <svg [attr.fill]="'none'" [attr.stroke]="'currentColor'" class="error-icon" viewBox="0 0 24 24">
          <path [attr.d]="'M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z'" [attr.stroke-linecap]="'round'"
                [attr.stroke-linejoin]="'round'" [attr.stroke-width]="2"></path>
        </svg>
        <div class="error-text">
          <h3 class="error-title">Error</h3>
          <p class="error-message">{{ error }}</p>
        </div>
      </div>
    </div>

    <!-- Form -->
    <form *ngIf="!loading" [formGroup]="worldbookForm" (ngSubmit)="onSubmit()" class="worldbook-form">
      <div class="form-card">
        <!-- Name Field -->
        <div class="form-group">
          <label for="name" class="form-label">
            Worldbook Name
            <span class="required">*</span>
          </label>
          <input
            id="name"
            type="text"
            formControlName="name"
            class="form-input"
            placeholder="Enter worldbook name"
            [class.error]="nameControl?.invalid && nameControl?.touched"
          />
          <div *ngIf="nameControl?.invalid && nameControl?.touched" class="field-error">
            <span *ngIf="nameControl?.errors?.['required']">Worldbook name is required</span>
            <span *ngIf="nameControl?.errors?.['maxlength']">Worldbook name must not exceed 200 characters</span>
          </div>
        </div>

        <!-- Action Buttons -->
        <div class="form-actions">
          <button type="button" (click)="cancel()" class="btn-cancel" [disabled]="saving">
            Cancel
          </button>
          <button type="submit" class="btn-submit" [disabled]="saving || worldbookForm.invalid">
            <svg *ngIf="saving" [attr.fill]="'none'" class="btn-spinner" viewBox="0 0 24 24">
              <circle [attr.cx]="12" [attr.cy]="12" [attr.r]="10" [attr.stroke-width]="4" [attr.stroke]="'currentColor'"
                      class="opacity-25"></circle>
              <path
                [attr.d]="'M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z'"
                [attr.fill]="'currentColor'" class="opacity-75"></path>
            </svg>
            <span>{{ saving ? 'Saving...' : (isEditMode ? 'Update Worldbook' : 'Create Worldbook') }}</span>
          </button>
        </div>
      </div>
    </form>
  </div>
</div>
