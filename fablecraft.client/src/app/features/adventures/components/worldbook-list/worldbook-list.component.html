<div class="worldbooks-container">
  <div class="worldbooks-content">
    <!-- Header -->
    <div class="worldbooks-header">
      <div class="header-left">
        <button (click)="goBack()" class="back-button">
          <svg [attr.fill]="'none'" [attr.stroke]="'currentColor'" viewBox="0 0 24 24">
            <path [attr.d]="'M10 19l-7-7m0 0l7-7m-7 7h18'" [attr.stroke-linecap]="'round'"
                  [attr.stroke-linejoin]="'round'" [attr.stroke-width]="2"></path>
          </svg>
        </button>
        <h1 class="page-title">Worldbooks</h1>
      </div>
      <button (click)="createNewWorldbook()" class="btn-new-worldbook">
        <svg [attr.fill]="'none'" [attr.stroke]="'currentColor'" viewBox="0 0 24 24">
          <path [attr.d]="'M12 4v16m8-8H4'" [attr.stroke-linecap]="'round'" [attr.stroke-linejoin]="'round'"
                [attr.stroke-width]="2"></path>
        </svg>
        <span>New Worldbook</span>
      </button>
    </div>

    <!-- Loading State -->
    <div *ngIf="loading" class="loading-state">
      <div class="loading-content">
        <svg [attr.fill]="'none'" class="spinner" viewBox="0 0 24 24">
          <circle [attr.cx]="12" [attr.cy]="12" [attr.r]="10" [attr.stroke-width]="4" [attr.stroke]="'currentColor'"
                  class="opacity-25"></circle>
          <path
            [attr.d]="'M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z'"
            [attr.fill]="'currentColor'" class="opacity-75"></path>
        </svg>
        <p class="loading-text">Loading worldbooks...</p>
      </div>
    </div>

    <!-- Error State -->
    <div *ngIf="error && !loading" class="error-state">
      <div class="error-content">
        <svg [attr.fill]="'none'" [attr.stroke]="'currentColor'" class="error-icon" viewBox="0 0 24 24">
          <path [attr.d]="'M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z'" [attr.stroke-linecap]="'round'"
                [attr.stroke-linejoin]="'round'" [attr.stroke-width]="2"></path>
        </svg>
        <div class="error-text">
          <h3 class="error-title">Error Loading Worldbooks</h3>
          <p class="error-message">{{ error }}</p>
        </div>
      </div>
    </div>

    <!-- Empty State -->
    <div *ngIf="!loading && !error && worldbooks.length === 0" class="empty-state">
      <div class="empty-content">
        <svg [attr.fill]="'none'" [attr.stroke]="'currentColor'" class="empty-icon" viewBox="0 0 24 24">
          <path
            [attr.d]="'M12 6.253v13m0-13C10.832 5.477 9.246 5 7.5 5S4.168 5.477 3 6.253v13C4.168 18.477 5.754 18 7.5 18s3.332.477 4.5 1.253m0-13C13.168 5.477 14.754 5 16.5 5c1.747 0 3.332.477 4.5 1.253v13C19.832 18.477 18.247 18 16.5 18c-1.746 0-3.332.477-4.5 1.253'"
            [attr.stroke-linecap]="'round'" [attr.stroke-linejoin]="'round'" [attr.stroke-width]="2"></path>
        </svg>
        <h2 class="empty-title">No Worldbooks Yet</h2>
        <p class="empty-description">
          Create your first worldbook to organize lorebooks and build rich, detailed worlds for your adventures.
        </p>
        <button (click)="createNewWorldbook()" class="btn-create-first">
          <svg [attr.fill]="'none'" [attr.stroke]="'currentColor'" viewBox="0 0 24 24">
            <path [attr.d]="'M12 4v16m8-8H4'" [attr.stroke-linecap]="'round'" [attr.stroke-linejoin]="'round'"
                  [attr.stroke-width]="2"></path>
          </svg>
          <span>Create Your First Worldbook</span>
        </button>
      </div>
    </div>

    <!-- Worldbooks Grid -->
    <div *ngIf="!loading && worldbooks.length > 0" class="worldbooks-grid">
      <div
        (click)="editWorldbook(worldbook)"
        *ngFor="let worldbook of worldbooks"
        class="worldbook-card">
        <!-- Delete Button -->
        <button
          (click)="deleteWorldbook($event, worldbook.id, worldbook.name)"
          class="delete-button"
          title="Delete worldbook">
          <svg [attr.fill]="'none'" [attr.stroke]="'currentColor'" viewBox="0 0 24 24">
            <path
              [attr.d]="'M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16'"
              [attr.stroke-linecap]="'round'" [attr.stroke-linejoin]="'round'" [attr.stroke-width]="2"></path>
          </svg>
        </button>

        <!-- Title and Description -->
        <h3 class="card-title">{{ worldbook.name }}</h3>
        <p class="card-description">
          {{ worldbook.lorebooks.length }} lorebook(s)
        </p>

        <!-- Hover Arrow -->
        <div class="card-arrow">
          <svg [attr.fill]="'none'" [attr.stroke]="'currentColor'" viewBox="0 0 24 24">
            <path [attr.d]="'M13 7l5 5m0 0l-5 5m5-5H6'" [attr.stroke-linecap]="'round'" [attr.stroke-linejoin]="'round'"
                  [attr.stroke-width]="2"></path>
          </svg>
        </div>
      </div>
    </div>
  </div>

  <!-- Delete Confirmation Modal -->
  <app-delete-confirmation-modal
    (cancel)="cancelDelete()"
    (confirm)="confirmDelete()"
    [adventureName]="worldbookToDelete?.name || ''"
    [isDeleting]="isDeleting"
    [isOpen]="showDeleteModal">
  </app-delete-confirmation-modal>
</div>
